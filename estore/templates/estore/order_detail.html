{% extends 'estore/base.html' %}
{% load bootstrap4 %}

{% block content %}
    <div class="row">
        <div class="col-md-12">
            <h2> 訂單明細 </h2>
            <table class="table table-bordered">
                <thead>
                <tr>
                    <th width="80%">商品明細</th>
                    <th>單價</th>
                    <th>數量</th>
                </tr>
                </thead>
                <tbody>
                {% for item in object.orderitem_set.all %}
                    <tr>
                        <td>
                            {{ item.title }}
                        </td>
                        <td>
                            {{ item.price }}
                        </td>
                        <td>
                            {{ item.quantity }}
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            <div class="total clearfix">
                <span class="pull-right">總計 {{ object.total }} NTD</span>
            </div>
            <hr>
            <h2> 寄送資訊 </h2>
            <table class="table table-striped table-bordered">
                <tbody>
                <tr>
                    <td>
                        訂購人
                    </td>
                </tr>
                <tr>
                    <td>
                        {{ object.info.billing_name }} - {{ object.info.billing_address }}
                    </td>
                </tr>
                <tr>
                    <td>
                        收件人
                    </td>
                </tr>
                <tr>
                    <td>
                        {{ object.info.shipping_name }} - {{ object.info.shipping_address }}
                    </td>
                </tr>
                </tbody>
            </table>
            {% if not object.is_paid and not object.payment_method %}
            <div class="pull-right form-inline">
                <form action="{{ credit_form.action }}" method="POST" class="form-group">
                    {% bootstrap_form credit_form %}
                    {% bootstrap_button '以信用卡付款' button_type='submit' button_class='btn-lg btn-danger pull-right' %}
                </form>
                <form action="{{ vacc_form.action }}" method="POST" class="form-group">
                    {% bootstrap_form vacc_form %}
                    {% bootstrap_button '以 ATM 付款' button_type='submit' button_class='btn-lg btn-danger pull-right' %}
                </form>
            </div>
            {% elif object.payment_method == 'VACC' %}
                <p class="text-center">此訂單已選擇 ATM 轉帳付款</p>
                <table class="table table-striped table-bordered">
                <tbody>
                <tr>
                    <td>
                        銀行代號
                    </td>
                    <td>
                        {{ response_vacc_info.BankCode }}
                    </td>
                </tr>
                <tr>
                    <td>
                        轉帳帳號
                    </td>
                    <td>
                        {{ response_vacc_info.CodeNo }}
                    </td>
                </tr>
                <tr>
                    <td>
                        轉帳金額
                    </td>
                    <td>
                        {{ response_info.Amt }}
                    </td>
                </tr>
                <tr>
                    <td>
                        繳款截止日
                    </td>
                    <td>
                        {{ response_info.ExpireDate }}
                    </td>
                </tr>
                </tbody>
            </table>
            {% else %}
                <p class="text-center">此訂單已完成付款</p>
            {% endif %}
        </div>
    </div>
{% endblock %}